"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Modals = void 0;
var tslib_1 = require("tslib");
var React = require("react");
var piral_core_1 = require("piral-core");
var components_1 = require("./components");
function closeAll(modals) {
    modals.forEach(function (m) { return m.close(); });
}
function findModal(modals, name) {
    if (name) {
        var modal = Object.keys(modals)
            .filter(function (m) { return modals[m].name === name; })
            .map(function (m) { return modals[m]; })[0];
        return modal;
    }
    return undefined;
}
var Modals = function () {
    var modals = piral_core_1.useGlobalState(function (s) { return s.registry.modals; });
    var dialogs = piral_core_1.useGlobalState(function (s) { return s.modals; });
    var close = function () { return closeAll(dialogs); };
    var children = dialogs
        .map(function (n) {
        var reg = modals[n.name] || findModal(modals, n.alternative);
        var Component = reg && reg.component;
        var defaults = reg && reg.defaults;
        return (Component && (React.createElement(components_1.PiralModalsDialog, tslib_1.__assign({}, n, { key: n.name }),
            React.createElement(Component, { onClose: n.close, options: tslib_1.__assign(tslib_1.__assign({}, defaults), n.options) }))));
    })
        .filter(function (m) { return !!m; });
    var open = children.length > 0;
    return (React.createElement(components_1.PiralModalsHost, { open: open, close: close }, children));
};
exports.Modals = Modals;
exports.Modals.displayName = 'Modals';
//# sourceMappingURL=Modals.js.map